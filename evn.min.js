(function(b){b.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage"]};b.expr[":"].uncached=function(c){if(!b(c).is('img[src!=""]'))return!1;var e=new Image;return e.src=c.src,!e.complete};b.fn.waitForImages=function(c,e,j){var l=0,f=0;b.isPlainObject(c)&&(c=c.finished,e=c.each,j=c.waitForAll);c=c||b.noop;e=e||b.noop;j=!!j;if(!b.isFunction(c)||!b.isFunction(e))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var h=
b(this),k=[],p=b.waitForImages.hasImageProperties||[],q=/url\(\s*(['"]?)(.*?)\1\s*\)/g;j?h.find("*").andSelf().each(function(){var c=b(this);c.is("img:uncached")&&k.push({src:c.attr("src"),element:c[0]});b.each(p,function(b,e){var h=c.css(e),f;if(!h)return!0;for(;f=q.exec(h);)k.push({src:f[2],element:c[0]})})}):h.find("img:uncached").each(function(){k.push({src:this.src,element:this})});l=k.length;f=0;0===l&&c.call(h[0]);b.each(k,function(j,k){var t=new Image;b(t).bind("load.waitForImages error.waitForImages",
function(b){f++;e.call(k.element,f,l,"load"==b.type);if(f==l)return c.call(h[0]),!1});t.src=k.src})})}})(jQuery);function draggingSetup(){function b(b){view==ITEM&&(!0==b.touches?(j=b.changedTouches[0].pageX,l=b.changedTouches[0].pageY):(j=b.pageX,l=b.pageY),k=!0,n=s,IS_TOUCH||$body.addClass("dragging"))}function c(b){if(view==ITEM&&!0==k)if(!0==b.touches?(f=b.targetTouches[0].pageX-j,h=b.targetTouches[0].pageY-l):(f=b.pageX-j,h=b.pageY-l),n==s){if($view.css("-webkit-transform","translate3d("+f+"px,0,0)"),5<Math.abs(f)||5<Math.abs(h))Math.abs(f)>Math.abs(h)?(n=q,$view.css("-webkit-transition","none"),$matte.css("-webkit-transition",
"none"),clearTextSelections()):(n=p,$view.removeAttr("style"),$body.removeClass("dragging"))}else n==q&&(b.preventDefault(),dPad=0+parseInt(f/15),$view.css("-webkit-transform","translate3d("+f+"px,0,0)"),b=1-Math.round(100*(f/$(window).width()))/100,$matte.css("opacity",b))}function e(){view==ITEM&&!0==k&&(k=!1,n!=p&&($body.removeClass("dragging"),0==f?($view.css({"-webkit-transform":"translate3d(5%,0,0)","-webkit-transition":"all 0.3s cubic-bezier(0.245, 0.975, 0.605, 1.020)"}),$view.on("webkitTransitionEnd",
function(){$view.css({"-webkit-transform":"translate3d(0%,0,0)","-webkit-transition":"all 0.4s cubic-bezier(0.470, 1.650, 0.330, 0.690)"});$view.off("webkitTransitionEnd");$view.on("webkitTransitionEnd",function(){$view.removeAttr("style");$view.off("webkitTransitionEnd")})})):(f>$(window).width()/2&&closeItem(),$view.removeAttr("style"),$matte.removeAttr("style")),f=0))}var j=0,l=0,f=0,h=0,k=!1,p=0,q=1,s=2,n=s;IS_TOUCH&&(document.addEventListener("touchstart",b),document.addEventListener("touchmove",
c),document.addEventListener("touchend",e));$(".grabby").mousedown(b);$body.mousemove(c);$body.mouseup(e);$body.mouseleave(e)};function clerestorySetup(){$("html").on("click",".box-fold",toggleBox);$("html").on("click",".box-toggle-btn",toggleBox);$("html").on("click",".box-items > li",toggleSpread)}
function toggleBox(b){b.preventDefault();b=$(".box-contents");var c=b.attr("data-box"),e=b.attr("data-spread"),j=$(".box-fold");"spread"==e?toggleSpread():"unfolded"==c?($(".box-fold").parent().removeClass("box-open"),goHere=$(".box-top-point").position().top,$viewScroll.animate({scrollTop:goHere},"slow"),$(".box-fold > .frames").stepWise("backward",6,600,function(){}),j.removeClass("unfolded"),b.attr("data-box","folded")):($(".box-fold > .frames").stepWise("forward",6,600,function(){$(".box-fold").parent().addClass("box-open")}),
j.addClass("unfolded"),b.attr("data-box","unfolded"))}function toggleSpread(){var b=$(".box-contents");"spread"==b.attr("data-spread")?(b.attr("data-spread","stacked").removeClass("box-spread"),b=$(".box-top-point").position().top):(b.attr("data-spread","spread").addClass("box-spread"),b=$(".box-fold").position().top+$(".box-fold").height());$viewScroll.animate({scrollTop:b},"slow")}
(function(b){b.fn.stepWise=function(c,e,j,l){function f(){pos+=k;q.css("left",pos+"%");pos>p&&0>pos?window.setTimeout(function(){f()},h):(b(".box-fold > .frames").removeAttr("style"),l())}var h=j/e,k=-100,p=-100*(e-1),q=this;"backward"==c?(pos=p,k*=-1):"forward"==c?pos=0:console.log("unkown direction for animation");f();return q}})(jQuery);(function(){var b=Math,c=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"";/android/gi.test(navigator.appVersion);var e=/iphone|ipad/gi.test(navigator.appVersion),j=/playbook/gi.test(navigator.appVersion),l=/hp-tablet/gi.test(navigator.appVersion),f="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,h="ontouchstart"in window&&!l,k=c+"Transform"in document.documentElement.style,p=e||j,q=window.requestAnimationFrame||window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,17)},s=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,n="onorientationchange"in window?"orientationchange":"resize",t=h?"touchstart":"mousedown",u=h?"touchmove":"mousemove",v=h?"touchend":
"mouseup",w=h?"touchcancel":"mouseup",x="translate"+(f?"3d(":"("),y=f?",0)":")",e=function(a,b){var d=document,r;this.wrapper="object"==typeof a?a:d.getElementById(a);this.wrapper.style.overflow="hidden";this.scroller=this.wrapper.children[0];this.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,
onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(r in b)this.options[r]=b[r];this.x=this.options.x;this.y=this.options.y;this.options.useTransform=k?this.options.useTransform:!1;this.options.hScrollbar=this.options.hScroll&&this.options.hScrollbar;this.options.vScrollbar=this.options.vScroll&&this.options.vScrollbar;this.options.useTransition=p&&this.options.useTransition;this.scroller.style[c+"TransitionProperty"]=this.options.useTransform?"-"+c.toLowerCase()+"-transform":
"top left";this.scroller.style[c+"TransitionDuration"]="0";this.scroller.style[c+"TransformOrigin"]="0 0";this.options.useTransition&&(this.scroller.style[c+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");this.options.useTransform?this.scroller.style[c+"Transform"]=x+this.x+"px,"+this.y+"px"+y:this.scroller.style.cssText+=";position:absolute;top:"+this.y+"px;left:"+this.x+"px";this.refresh();this._bind(n,window);this._bind(t);h||this._bind("mouseout",this.wrapper)};e.prototype={enabled:!0,
x:0,y:0,steps:[],scale:1,handleEvent:function(a){switch(a.type){case t:if(!h&&0!==a.button)break;this._start(a);break;case u:this._move(a);break;case v:case w:this._end(a);break;case n:this._resize();break;case "mouseout":this._mouseout(a);break;case "webkitTransitionEnd":this._transitionEnd(a)}},_resize:function(){this.refresh()},_pos:function(a,b){a=this.hScroll?a:0;b=this.vScroll?b:0;this.options.useTransform?this.scroller.style[c+"Transform"]=x+a+"px,"+b+"px"+y+" scale("+this.scale+")":(a>>=0,
b>>=0,this.scroller.style.left=a+"px",this.scroller.style.top=b+"px");this.x=a;this.y=b},_start:function(a){var b=h?a.touches[0]:a,d,r;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,a);this.options.useTransition&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;if(this.options.momentum&&(this.options.useTransform?(d=getComputedStyle(this.scroller,null)[c+"Transform"].replace(/[^0-9-.,]/g,
"").split(","),r=1*d[4],d=1*d[5]):(r=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,""),d=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),r!=this.x||d!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):s(this.aniTime),this.steps=[],this._pos(r,d);this.startX=this.x;this.startY=this.y;this.pointX=b.pageX;this.pointY=b.pageY;this.startTime=a.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,a);this._bind(u);
this._bind(v);this._bind(w)}},_move:function(a){var m=h?a.touches[0]:a,d=m.pageX-this.pointX,c=m.pageY-this.pointY,g=this.x+d,e=this.y+c,f=a.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,a);this.pointX=m.pageX;this.pointY=m.pageY;if(0<g||g<this.maxScrollX)g=this.options.bounce?this.x+d/2:0<=g||0<=this.maxScrollX?0:this.maxScrollX;if(0<e||e<this.maxScrollY)e=this.options.bounce?this.y+c/2:0<=e||0<=this.maxScrollY?0:this.maxScrollY;this.distX+=d;this.distY+=
c;this.absDistX=b.abs(this.distX);this.absDistY=b.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(e=this.y,c=0):this.absDistY>this.absDistX+5&&(g=this.x,d=0)),this.moved=!0,this._pos(g,e),this.dirX=0<d?-1:0>d?1:0,this.dirY=0<c?-1:0>c?1:0,300<f-this.startTime&&(this.startTime=f,this.startX=this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,a))},_end:function(a){if(!(h&&0!=a.touches.length)){var m=
h?a.changedTouches[0]:a,d,c,g={dist:0,time:0},e={dist:0,time:0},f=(a.timeStamp||Date.now())-this.startTime;d=this.x;c=this.y;this._unbind(u);this._unbind(v);this._unbind(w);this.options.onBeforeScrollEnd&&this.options.onBeforeScrollEnd.call(this,a);if(this.moved){if(300>f&&this.options.momentum){g=d?this._momentum(d-this.startX,f,-this.x,this.scrollerW-this.wrapperW+this.x,this.options.bounce?this.wrapperW:0):g;e=c?this._momentum(c-this.startY,f,-this.y,0>this.maxScrollY?this.scrollerH-this.wrapperH+
this.y:0,this.options.bounce?this.wrapperH:0):e;d=this.x+g.dist;c=this.y+e.dist;if(0<this.x&&0<d||this.x<this.maxScrollX&&d<this.maxScrollX)g={dist:0,time:0};if(0<this.y&&0<c||this.y<this.maxScrollY&&c<this.maxScrollY)e={dist:0,time:0}}g.dist||e.dist?(m=b.max(b.max(g.time,e.time),10),this.scrollTo(d>>0,c>>0,m)):this._resetPos(200)}else{if(h){for(d=m.target;1!=d.nodeType;)d=d.parentNode;"SELECT"!=d.tagName&&("INPUT"!=d.tagName&&"TEXTAREA"!=d.tagName)&&(c=document.createEvent("MouseEvents"),c.initMouseEvent("click",
!0,!0,a.view,1,m.screenX,m.screenY,m.clientX,m.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),c._fake=!0,d.dispatchEvent(c))}this._resetPos(200)}this.options.onTouchEnd&&this.options.onTouchEnd.call(this,a)}},_resetPos:function(a){var b=0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,d=0<=this.y||0<this.maxScrollY?0:this.y<this.maxScrollY?this.maxScrollY:this.y;b==this.x&&d==this.y?this.moved&&(this.options.onScrollEnd&&this.options.onScrollEnd.call(this),this.moved=!1):this.scrollTo(b,
d,a||0)},_mouseout:function(a){var b=a.relatedTarget;if(b)for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){a.target==this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var a=this,c=a.x,d=a.y,e=Date.now(),g,f,h;a.animating||(a.steps.length?(g=a.steps.shift(),g.x==c&&g.y==d&&(g.time=0),a.animating=!0,a.moved=!0,a.options.useTransition?(a._transitionTime(g.time),a._pos(g.x,g.y),a.animating=!1,g.time?a._bind("webkitTransitionEnd"):
a._resetPos(0)):(h=function(){var j=Date.now(),k;j>=e+g.time?(a._pos(g.x,g.y),a.animating=!1,a.options.onAnimationEnd&&a.options.onAnimationEnd.call(a),a._startAni()):(j=(j-e)/g.time-1,f=b.sqrt(1-j*j),j=(g.x-c)*f+c,k=(g.y-d)*f+d,a._pos(j,k),a.animating&&(a.aniTime=q(h)))},h())):a._resetPos(400))},_transitionTime:function(a){this.scroller.style[c+"TransitionDuration"]=a+"ms"},_momentum:function(a,c,d,e,g){c=b.abs(a)/c;var f=c*c/0.0012;0<a&&f>d?(d+=g/(6/(6E-4*(f/c))),c=c*d/f,f=d):0>a&&f>e&&(e+=g/(6/
(6E-4*(f/c))),c=c*e/f,f=e);return{dist:f*(0>a?-1:1),time:c/6E-4>>0}},_offset:function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;return{left:b,top:c}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){this.scroller.style[c+"Transform"]="";this._unbind(n,window);this._unbind(t);this._unbind(u);this._unbind(v);this._unbind(w);this._unbind("mouseout",
this.wrapper);this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var a;this.wrapperW=this.wrapper.clientWidth;this.wrapperH=this.wrapper.clientHeight;this.scrollerW=this.scroller.offsetWidth;this.scrollerH=this.scroller.offsetHeight;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH;this.dirY=this.dirX=0;this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=
this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);a=this._offset(this.wrapper);this.wrapperOffsetLeft=-a.left;this.wrapperOffsetTop=-a.top;this.scroller.style[c+"TransitionDuration"]="0";this._resetPos(200)},scrollTo:function(a,b,c,e){var f=a;this.stop();f.length||(f=[{x:a,y:b,time:c,relative:e}]);a=0;for(b=f.length;a<b;a++)f[a].relative&&(f[a].x=this.x-f[a].x,f[a].y=this.y-f[a].y),this.steps.push({x:f[a].x,y:f[a].y,time:f[a].time||0});this._startAni()},
scrollToElement:function(a,c){var d;if(a=a.nodeType?a:this.scroller.querySelector(a))d=this._offset(a),d.left+=this.wrapperOffsetLeft,d.top+=this.wrapperOffsetTop,d.left=0<d.left?0:d.left<this.maxScrollX?this.maxScrollX:d.left,d.top=0<d.top?0:d.top<this.maxScrollY?this.maxScrollY:d.top,c=void 0===c?b.max(2*b.abs(d.left),2*b.abs(d.top)):c,this.scrollTo(d.left,d.top,c)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(u);this._unbind(v);this._unbind(w)},enable:function(){this.enabled=
!0},stop:function(){s(this.aniTime);this.steps=[];this.animating=this.moved=!1}};"undefined"!==typeof exports?exports.iScroll=e:window.iScroll=e})();var MY_EMAIL="ebrooks@risd.edu",MY_NAME="Evan Brooks",$view,$viewScroll,$body,$index,$matte,$currItem,$itemName,$itemDate,$itemContent,whichCurrItem,INDEX,ITEM,view,IS_TOUCH;
$(function(){$view=$(".view");$viewScroll=$(".view-scroller");$body=$("body");$index=$(".index");$matte=$(".matte");$currItem=null;$itemName=$(".view .title");$itemDate=$(".view .subtitle");$itemContent=$(".view-scroller");whichCurrItem="";IS_TOUCH=isTouchDevice();INDEX=0;ITEM=1;view=INDEX;$.ajaxSetup({cache:!1});IS_TOUCH&&(new iScroll("iScroll"),$("body").addClass("i-scroll"));$("html").on("click",".inner",function(){null!=$currItem&&$currItem.removeClass("active");$currItem=$(this);$currItem.addClass("active");
openItem($currItem.attr("data-item"))});$matte.click(closeItem);$("html").on("click",".togCap",function(){$(this).parent().toggleClass("show-caption")});draggingSetup();window.addEventListener("popstate",function(){""!=window.location.hash?(whichItem=window.location.hash.split("#/"),openItem(whichItem[1])):closeItem()});$(window).resize(iRefresh);$(window).on("onorientationchange",iRefresh);$("html").on("click","[data-action = actionsheet]",function(b){b.preventDefault();$body.addClass("action-mode")});
$("html").on("click","[data-action = copy]",function(b){b.preventDefault();$(".actions input").val(MY_EMAIL);el=document.getElementById("email");el.selectionStart=0;el.selectionEnd=el.value.length});$(".actions input").blur(function(){$(".actions .flip-wrap").removeClass("flipped")});$("html").on("click","[data-flip]",function(){type=$(this).attr("data-flip");"permanent"==type?$(this).addClass("flipped"):$(this).toggleClass("flipped")});clerestorySetup()});
function openItem(b){history.pushState({},"","#/"+b);view=ITEM;b!=whichCurrItem?(whichCurrItem=b,url="/item/"+b+".html",$body.addClass("loading"),$viewScroll.scrollTop(0),$.ajax(url).done(function(b){content=b.split("==");setTitle(content[0]);$itemName.html(content[0]);$itemDate.html(content[1]);b=content[2].split("\n#");var e="";$itemContent.html("");for(i=1;i<b.length;i++){content=b[i].split("\n--");attr=content[0].split(": ");attrHtml='class="'+attr[0]+'"';var j="";1<attr.length&&(j='<img src="'+
attr[1]+'">');e+="<section "+attrHtml+">";e+=j;e+=content[1];e+="</section>"}$itemContent.append(e);$view.waitForImages(function(){$body.removeClass("loading").addClass("item-mode");iRefresh()})}).error(function(){setTitle("Nothing");$itemName.html("");$itemDate.html("");$itemContent.html('<section class="text">Not available right now</section>');$body.removeClass("loading").addClass("item-mode")})):$body.addClass("item-mode")}
function closeItem(){$body.removeClass("item-mode action-mode");view=INDEX;history.pushState({},"","/");setTitle("Portfolio")}function isTouchDevice(){var b=document.createElement("div");b.setAttribute("ongesturestart","return;");return"function"===typeof b.ongesturestart}function iRefresh(){IS_TOUCH&&setTimeout(function(){myScroll.refresh()},0)}
function clearTextSelections(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function setTitle(b){document.title=MY_NAME+" \u2014 "+b};
