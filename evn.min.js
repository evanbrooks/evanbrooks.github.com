(function(b){b.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage"]};b.expr[":"].uncached=function(c){if(!b(c).is('img[src!=""]'))return!1;var d=new Image;return d.src=c.src,!d.complete};b.fn.waitForImages=function(c,d,e){var m=0,h=0;b.isPlainObject(c)&&(c=c.finished,d=c.each,e=c.waitForAll);c=c||b.noop;d=d||b.noop;e=!!e;if(!b.isFunction(c)||!b.isFunction(d))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var g=
b(this),l=[],p=b.waitForImages.hasImageProperties||[],q=/url\(\s*(['"]?)(.*?)\1\s*\)/g;e?g.find("*").andSelf().each(function(){var c=b(this);c.is("img:uncached")&&l.push({src:c.attr("src"),element:c[0]});b.each(p,function(b,d){var e=c.css(d),g;if(!e)return!0;for(;g=q.exec(e);)l.push({src:g[2],element:c[0]})})}):g.find("img:uncached").each(function(){l.push({src:this.src,element:this})});m=l.length;h=0;0===m&&c.call(g[0]);b.each(l,function(e,l){var t=new Image;b(t).bind("load.waitForImages error.waitForImages",
function(b){h++;d.call(l.element,h,m,"load"==b.type);if(h==m)return c.call(g[0]),!1});t.src=l.src})})}})(jQuery);function draggingSetup(){function b(b){view==ITEM&&(!0==b.touches?(e=b.changedTouches[0].pageX,m=b.changedTouches[0].pageY):(e=b.pageX,m=b.pageY),l=!0,n=s,IS_TOUCH||$body.addClass("dragging"))}function c(b){if(view==ITEM&&!0==l)if(!0==b.touches?(h=b.targetTouches[0].pageX-e,g=b.targetTouches[0].pageY-m):(h=b.pageX-e,g=b.pageY-m),n==s){if($view.css("-webkit-transform","translate3d("+h+"px,0,0)"),5<Math.abs(h)||5<Math.abs(g))Math.abs(h)>Math.abs(g)?(n=q,$view.css("-webkit-transition","none"),$matte.css("-webkit-transition",
"none"),clearTextSelections()):(n=p,$view.removeAttr("style"),$body.removeClass("dragging"))}else n==q&&(b.preventDefault(),dPad=0+parseInt(h/15),$view.css("-webkit-transform","translate3d("+h+"px,0,0)"),b=1-Math.round(100*(h/$(window).width()))/100,$matte.css("opacity",b))}function d(){view==ITEM&&!0==l&&(l=!1,n!=p&&($body.removeClass("dragging"),0==h?($view.css({"-webkit-transform":"translate3d(5%,0,0)","-webkit-transition":"all 0.3s cubic-bezier(0.245, 0.975, 0.605, 1.020)"}),$view.on("webkitTransitionEnd",
function(){$view.css({"-webkit-transform":"translate3d(0%,0,0)","-webkit-transition":"all 0.4s cubic-bezier(0.470, 1.650, 0.330, 0.690)"});$view.off("webkitTransitionEnd");$view.on("webkitTransitionEnd",function(){$view.removeAttr("style");$view.off("webkitTransitionEnd")})})):(h>$(window).width()/2&&closeItem(),$view.removeAttr("style"),$matte.removeAttr("style")),h=0))}var e=0,m=0,h=0,g=0,l=!1,p=0,q=1,s=2,n=s;IS_TOUCH&&(document.addEventListener("touchstart",b),document.addEventListener("touchmove",
c),document.addEventListener("touchend",d));$(".grabby").mousedown(b);$body.mousemove(c);$body.mouseup(d);$body.mouseleave(d)};function clerestorySetup(){$("html").on("click",".box-fold",toggleBox);$("html").on("click",".box-toggle-btn",toggleBox);$("html").on("click",".box-items > li",toggleSpread)}
function toggleBox(b){b.preventDefault();b=$(".box-contents");var c=b.attr("data-box"),d=b.attr("data-spread"),e=$(".box-fold");"spread"==d?toggleSpread():"unfolded"==c?($(".box-fold").parent().removeClass("box-open"),goHere=$(".box-top-point").offset().top,clScrollTo(goHere),$(".box-fold > .frames").stepWise("backward",6,600,function(){}),e.removeClass("unfolded"),b.attr("data-box","folded")):($(".box-fold > .frames").stepWise("forward",6,600,function(){$(".box-fold").parent().addClass("box-open")}),
e.addClass("unfolded"),b.attr("data-box","unfolded"))}function toggleSpread(){var b=$(".box-contents");"spread"==b.attr("data-spread")?(b.attr("data-spread","stacked").removeClass("box-spread"),b=$(".box-top-point").offset().top):(b.attr("data-spread","spread").addClass("box-spread"),b=$(".box-fold").offset().top+$(".box-fold").height());clScrollTo(b)}function clScrollTo(b){if(!IS_TOUCH){var c=$viewScroll.scrollTop();$viewScroll.animate({scrollTop:b+c},"slow")}}
(function(b){b.fn.stepWise=function(c,d,e,m){function h(){pos+=l;q.css("left",pos+"%");pos>p&&0>pos?window.setTimeout(function(){h()},g):(b(".box-fold > .frames").removeAttr("style"),m())}var g=e/d,l=-100,p=-100*(d-1),q=this;"backward"==c?(pos=p,l*=-1):"forward"==c?pos=0:console.log("unkown direction for animation");h();return q}})(jQuery);(function(){var b=Math,c=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"";/android/gi.test(navigator.appVersion);var d=/iphone|ipad/gi.test(navigator.appVersion),e=/playbook/gi.test(navigator.appVersion),m=/hp-tablet/gi.test(navigator.appVersion),h="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,g="ontouchstart"in window&&!m,l=c+"Transform"in document.documentElement.style,p=d||e,q=window.requestAnimationFrame||window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,17)},s=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,n="onorientationchange"in window?"orientationchange":"resize",t=g?"touchstart":"mousedown",u=g?"touchmove":"mousemove",v=g?"touchend":
"mouseup",w=g?"touchcancel":"mouseup",y="translate"+(h?"3d(":"("),z=h?",0)":")",d=function(a,b){var f=document,r;this.wrapper="object"==typeof a?a:f.getElementById(a);this.wrapper.style.overflow="hidden";this.scroller=this.wrapper.children[0];this.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,
onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(r in b)this.options[r]=b[r];this.x=this.options.x;this.y=this.options.y;this.options.useTransform=l?this.options.useTransform:!1;this.options.hScrollbar=this.options.hScroll&&this.options.hScrollbar;this.options.vScrollbar=this.options.vScroll&&this.options.vScrollbar;this.options.useTransition=p&&this.options.useTransition;this.scroller.style[c+"TransitionProperty"]=this.options.useTransform?"-"+c.toLowerCase()+"-transform":
"top left";this.scroller.style[c+"TransitionDuration"]="0";this.scroller.style[c+"TransformOrigin"]="0 0";this.options.useTransition&&(this.scroller.style[c+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");this.options.useTransform?this.scroller.style[c+"Transform"]=y+this.x+"px,"+this.y+"px"+z:this.scroller.style.cssText+=";position:absolute;top:"+this.y+"px;left:"+this.x+"px";this.refresh();this._bind(n,window);this._bind(t);g||this._bind("mouseout",this.wrapper)};d.prototype={enabled:!0,
x:0,y:0,steps:[],scale:1,handleEvent:function(a){switch(a.type){case t:if(!g&&0!==a.button)break;this._start(a);break;case u:this._move(a);break;case v:case w:this._end(a);break;case n:this._resize();break;case "mouseout":this._mouseout(a);break;case "webkitTransitionEnd":this._transitionEnd(a)}},_resize:function(){this.refresh()},_pos:function(a,b){a=this.hScroll?a:0;b=this.vScroll?b:0;this.options.useTransform?this.scroller.style[c+"Transform"]=y+a+"px,"+b+"px"+z+" scale("+this.scale+")":(a>>=0,
b>>=0,this.scroller.style.left=a+"px",this.scroller.style.top=b+"px");this.x=a;this.y=b},_start:function(a){var b=g?a.touches[0]:a,f,r;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,a);this.options.useTransition&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;if(this.options.momentum&&(this.options.useTransform?(f=getComputedStyle(this.scroller,null)[c+"Transform"].replace(/[^0-9-.,]/g,
"").split(","),r=1*f[4],f=1*f[5]):(r=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,""),f=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),r!=this.x||f!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):s(this.aniTime),this.steps=[],this._pos(r,f);this.startX=this.x;this.startY=this.y;this.pointX=b.pageX;this.pointY=b.pageY;this.startTime=a.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,a);this._bind(u);
this._bind(v);this._bind(w)}},_move:function(a){var x=g?a.touches[0]:a,f=x.pageX-this.pointX,c=x.pageY-this.pointY,k=this.x+f,d=this.y+c,e=a.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,a);this.pointX=x.pageX;this.pointY=x.pageY;if(0<k||k<this.maxScrollX)k=this.options.bounce?this.x+f/2:0<=k||0<=this.maxScrollX?0:this.maxScrollX;if(0<d||d<this.maxScrollY)d=this.options.bounce?this.y+c/2:0<=d||0<=this.maxScrollY?0:this.maxScrollY;this.distX+=f;this.distY+=
c;this.absDistX=b.abs(this.distX);this.absDistY=b.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(d=this.y,c=0):this.absDistY>this.absDistX+5&&(k=this.x,f=0)),this.moved=!0,this._pos(k,d),this.dirX=0<f?-1:0>f?1:0,this.dirY=0<c?-1:0>c?1:0,300<e-this.startTime&&(this.startTime=e,this.startX=this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,a))},_end:function(a){if(!(g&&0!=a.touches.length)){var c=
g?a.changedTouches[0]:a,f,d,k={dist:0,time:0},e={dist:0,time:0},h=(a.timeStamp||Date.now())-this.startTime;f=this.x;d=this.y;this._unbind(u);this._unbind(v);this._unbind(w);this.options.onBeforeScrollEnd&&this.options.onBeforeScrollEnd.call(this,a);if(this.moved){if(300>h&&this.options.momentum){k=f?this._momentum(f-this.startX,h,-this.x,this.scrollerW-this.wrapperW+this.x,this.options.bounce?this.wrapperW:0):k;e=d?this._momentum(d-this.startY,h,-this.y,0>this.maxScrollY?this.scrollerH-this.wrapperH+
this.y:0,this.options.bounce?this.wrapperH:0):e;f=this.x+k.dist;d=this.y+e.dist;if(0<this.x&&0<f||this.x<this.maxScrollX&&f<this.maxScrollX)k={dist:0,time:0};if(0<this.y&&0<d||this.y<this.maxScrollY&&d<this.maxScrollY)e={dist:0,time:0}}k.dist||e.dist?(c=b.max(b.max(k.time,e.time),10),this.scrollTo(f>>0,d>>0,c)):this._resetPos(200)}else{if(g){for(f=c.target;1!=f.nodeType;)f=f.parentNode;"SELECT"!=f.tagName&&("INPUT"!=f.tagName&&"TEXTAREA"!=f.tagName)&&(d=document.createEvent("MouseEvents"),d.initMouseEvent("click",
!0,!0,a.view,1,c.screenX,c.screenY,c.clientX,c.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),d._fake=!0,f.dispatchEvent(d))}this._resetPos(200)}this.options.onTouchEnd&&this.options.onTouchEnd.call(this,a)}},_resetPos:function(a){var b=0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,f=0<=this.y||0<this.maxScrollY?0:this.y<this.maxScrollY?this.maxScrollY:this.y;b==this.x&&f==this.y?this.moved&&(this.options.onScrollEnd&&this.options.onScrollEnd.call(this),this.moved=!1):this.scrollTo(b,
f,a||0)},_mouseout:function(a){var b=a.relatedTarget;if(b)for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){a.target==this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var a=this,c=a.x,f=a.y,d=Date.now(),k,e,h;a.animating||(a.steps.length?(k=a.steps.shift(),k.x==c&&k.y==f&&(k.time=0),a.animating=!0,a.moved=!0,a.options.useTransition?(a._transitionTime(k.time),a._pos(k.x,k.y),a.animating=!1,k.time?a._bind("webkitTransitionEnd"):
a._resetPos(0)):(h=function(){var g=Date.now(),l;g>=d+k.time?(a._pos(k.x,k.y),a.animating=!1,a.options.onAnimationEnd&&a.options.onAnimationEnd.call(a),a._startAni()):(g=(g-d)/k.time-1,e=b.sqrt(1-g*g),g=(k.x-c)*e+c,l=(k.y-f)*e+f,a._pos(g,l),a.animating&&(a.aniTime=q(h)))},h())):a._resetPos(400))},_transitionTime:function(a){this.scroller.style[c+"TransitionDuration"]=a+"ms"},_momentum:function(a,c,f,d,e){c=b.abs(a)/c;var g=c*c/0.0012;0<a&&g>f?(f+=e/(6/(6E-4*(g/c))),c=c*f/g,g=f):0>a&&g>d&&(d+=e/(6/
(6E-4*(g/c))),c=c*d/g,g=d);return{dist:g*(0>a?-1:1),time:c/6E-4>>0}},_offset:function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;return{left:b,top:c}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){this.scroller.style[c+"Transform"]="";this._unbind(n,window);this._unbind(t);this._unbind(u);this._unbind(v);this._unbind(w);this._unbind("mouseout",
this.wrapper);this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var a;this.wrapperW=this.wrapper.clientWidth;this.wrapperH=this.wrapper.clientHeight;this.scrollerW=this.scroller.offsetWidth;this.scrollerH=this.scroller.offsetHeight;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH;this.dirY=this.dirX=0;this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=
this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);a=this._offset(this.wrapper);this.wrapperOffsetLeft=-a.left;this.wrapperOffsetTop=-a.top;this.scroller.style[c+"TransitionDuration"]="0";this._resetPos(200)},scrollTo:function(a,b,c,d){var e=a;this.stop();e.length||(e=[{x:a,y:b,time:c,relative:d}]);a=0;for(b=e.length;a<b;a++)e[a].relative&&(e[a].x=this.x-e[a].x,e[a].y=this.y-e[a].y),this.steps.push({x:e[a].x,y:e[a].y,time:e[a].time||0});this._startAni()},
scrollToElement:function(a,c){var d;if(a=a.nodeType?a:this.scroller.querySelector(a))d=this._offset(a),d.left+=this.wrapperOffsetLeft,d.top+=this.wrapperOffsetTop,d.left=0<d.left?0:d.left<this.maxScrollX?this.maxScrollX:d.left,d.top=0<d.top?0:d.top<this.maxScrollY?this.maxScrollY:d.top,c=void 0===c?b.max(2*b.abs(d.left),2*b.abs(d.top)):c,this.scrollTo(d.left,d.top,c)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(u);this._unbind(v);this._unbind(w)},enable:function(){this.enabled=
!0},stop:function(){s(this.aniTime);this.steps=[];this.animating=this.moved=!1}};"undefined"!==typeof exports?exports.iScroll=d:window.iScroll=d})();var MY_EMAIL="ebrooks@risd.edu",MY_NAME="Evan Brooks",$view,$viewScroll,$body,$index,$matte,$currItem,$itemName,$itemDate,$itemContent,whichCurrItem,INDEX,ITEM,view,IS_TOUCH;
$(function(){$view=$(".view");$viewScroll=$(".view-scroller");$body=$("body");$index=$(".index");$matte=$(".matte");$currItem=null;$itemName=$(".view .title");$itemDate=$(".view .subtitle");$itemContent=$(".view-scroller");whichCurrItem="";IS_TOUCH=isTouchDevice();INDEX=0;ITEM=1;view=INDEX;$.ajaxSetup({cache:!1});$("html").on("click",".inner",function(){null!=$currItem&&$currItem.removeClass("active");$currItem=$(this);$currItem.addClass("active");openItem($currItem.attr("data-item"))});$matte.click(closeItem);
$("html").on("click",".togCap",function(){$(this).parent().toggleClass("show-caption")});draggingSetup();window.addEventListener("popstate",function(){""!=window.location.hash?(whichItem=window.location.hash.split("#/"),openItem(whichItem[1])):closeItem()});$(window).resize(iRefresh);$(window).on("onorientationchange",iRefresh);$("html").on("click","[data-action = actionsheet]",function(b){b.preventDefault();$body.addClass("action-mode")});$("html").on("click","[data-action = copy]",function(b){b.preventDefault();
$(".actions input").val(MY_EMAIL);el=document.getElementById("email");el.selectionStart=0;el.selectionEnd=el.value.length});$(".actions input").blur(function(){$(".actions .flip-wrap").removeClass("flipped")});$("html").on("click","[data-flip]",function(){type=$(this).attr("data-flip");"permanent"==type?$(this).addClass("flipped"):$(this).toggleClass("flipped")});$("html").on("click",".cropped",function(){$(this).toggleClass("uncropped")});clerestorySetup()});
function openItem(b){history.pushState({},"","#/"+b);view=ITEM;b!=whichCurrItem?(whichCurrItem=b,url="/item/"+b+".html",$body.addClass("loading"),$viewScroll.scrollTop(0),$.ajax(url).done(function(b){content=b.split("==");setTitle(content[0]);$itemName.html(content[0]);$itemDate.html(content[1]);b=content[2].split("\n#");var d="";$itemContent.html("");for(i=1;i<b.length;i++){content=b[i].split("\n--");attr=content[0].split(":");attrHtml='class="'+attr[0]+'"';var e="";if(-1!==attr[0].indexOf("img"))for(j=
1;j<attr.length;j++)src=attr[j].replace(/(^\s+|\s+$)/g,""),e+='<img src="'+src+'">';-1!==attr[0].indexOf("windowed")&&(e="",src=attr[1].replace(/(^\s+|\s+$)/g,""),e+='<div class="browser">',e+='<img src="'+src+'">',e+="</div>");d+="<section "+attrHtml+">";d+=e;d+=content[1];d+="</section>"}$itemContent.append(d);$view.waitForImages(function(){$body.removeClass("loading").addClass("item-mode");iRefresh()})}).error(function(){setTitle("Nothing");$itemName.html("");$itemDate.html("");$itemContent.html('<section class="text">Not available right now</section>');
$body.removeClass("loading").addClass("item-mode")})):$body.addClass("item-mode")}function closeItem(){$body.removeClass("item-mode action-mode");view=INDEX;history.pushState({},"","/");setTitle("Portfolio")}function isTouchDevice(){var b=document.createElement("div");b.setAttribute("ongesturestart","return;");return"function"===typeof b.ongesturestart}function iRefresh(){IS_TOUCH&&setTimeout(function(){myScroll.refresh()},0)}
function clearTextSelections(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function setTitle(b){document.title=MY_NAME+" \u2014 "+b};
