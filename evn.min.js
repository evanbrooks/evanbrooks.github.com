(function(b){b.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage"]};b.expr[":"].uncached=function(c){if(!b(c).is('img[src!=""]'))return!1;var d=new Image;return d.src=c.src,!d.complete};b.fn.waitForImages=function(c,d,g){var l=0,e=0;b.isPlainObject(c)&&(c=c.finished,d=c.each,g=c.waitForAll);c=c||b.noop;d=d||b.noop;g=!!g;if(!b.isFunction(c)||!b.isFunction(d))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var j=
b(this),k=[],n=b.waitForImages.hasImageProperties||[],p=/url\(\s*(['"]?)(.*?)\1\s*\)/g;g?j.find("*").andSelf().each(function(){var c=b(this);c.is("img:uncached")&&k.push({src:c.attr("src"),element:c[0]});b.each(n,function(b,d){var j=c.css(d),e;if(!j)return!0;for(;e=p.exec(j);)k.push({src:e[2],element:c[0]})})}):j.find("img:uncached").each(function(){k.push({src:this.src,element:this})});l=k.length;e=0;0===l&&c.call(j[0]);b.each(k,function(g,k){var s=new Image;b(s).bind("load.waitForImages error.waitForImages",
function(b){e++;d.call(k.element,e,l,"load"==b.type);if(e==l)return c.call(j[0]),!1});s.src=k.src})})}})(jQuery);function draggingSetup(){function b(b){view==ITEM&&(!0==b.touches?(g=b.changedTouches[0].pageX,l=b.changedTouches[0].pageY):(g=b.pageX,l=b.pageY),k=!0,m=r,IS_TOUCH||$body.addClass("dragging"))}function c(b){if(view==ITEM&&!0==k)if(!0==b.touches?(e=b.targetTouches[0].pageX-g,j=b.targetTouches[0].pageY-l):(e=b.pageX-g,j=b.pageY-l),m==r){if($view.css("-webkit-transform","translate3d("+e+"px,0,0)"),5<Math.abs(e)||5<Math.abs(j))Math.abs(e)>Math.abs(j)?(m=p,$view.css("-webkit-transition","none"),$matte.css("-webkit-transition",
"none"),clearTextSelections()):(m=n,$view.removeAttr("style"),$body.removeClass("dragging"))}else m==p&&(b.preventDefault(),dPad=0+parseInt(e/15),$view.css("-webkit-transform","translate3d("+e+"px,0,0)"),b=1-Math.round(100*(e/$(window).width()))/100,$matte.css("opacity",b))}function d(){view==ITEM&&!0==k&&(k=!1,m!=n&&($body.removeClass("dragging"),0==e?($view.css({"-webkit-transform":"translate3d(5%,0,0)","-webkit-transition":"all 0.3s cubic-bezier(0.245, 0.975, 0.605, 1.020)"}),$view.on("webkitTransitionEnd",
function(){$view.css({"-webkit-transform":"translate3d(0%,0,0)","-webkit-transition":"all 0.4s cubic-bezier(0.470, 1.650, 0.330, 0.690)"});$view.off("webkitTransitionEnd");$view.on("webkitTransitionEnd",function(){$view.removeAttr("style");$view.off("webkitTransitionEnd")})})):(e>$(window).width()/2&&closeItem(),$view.removeAttr("style"),$matte.removeAttr("style")),e=0))}var g=0,l=0,e=0,j=0,k=!1,n=0,p=1,r=2,m=r;IS_TOUCH&&(document.addEventListener("touchstart",b),document.addEventListener("touchmove",
c),document.addEventListener("touchend",d));$(".grabby").mousedown(b);$body.mousemove(c);$body.mouseup(d);$body.mouseleave(d)};function clerestorySetup(){$("html").on("click",".box-fold",toggleBox);$("html").on("click",".box-toggle-btn",toggleBox);$("html").on("click",".box-items > li",toggleSpread)}
function toggleBox(b){b.preventDefault();b=$(".box-contents");var c=b.attr("data-box"),d=b.attr("data-spread"),g=$(".box-fold");"spread"==d?toggleSpread():"unfolded"==c?($(".box-fold").parent().removeClass("box-open"),goHere=$(".box-top-point").offset().top,$viewScroll.animate({scrollTop:goHere+currScroll},"slow"),$(".box-fold > .frames").stepWise("backward",6,600,function(){}),g.removeClass("unfolded"),b.attr("data-box","folded")):($(".box-fold > .frames").stepWise("forward",6,600,function(){$(".box-fold").parent().addClass("box-open")}),
g.addClass("unfolded"),b.attr("data-box","unfolded"))}function toggleSpread(){var b=$(".box-contents"),c=b.attr("data-spread"),d=$viewScroll.scrollTop();"spread"==c?(b.attr("data-spread","stacked").removeClass("box-spread"),b=$(".box-top-point").offset().top):(b.attr("data-spread","spread").addClass("box-spread"),b=$(".box-fold").offset().top+$(".box-fold").height());$viewScroll.animate({scrollTop:b+d},"slow")}
(function(b){b.fn.stepWise=function(c,d,g,l){function e(){pos+=k;p.css("left",pos+"%");pos>n&&0>pos?window.setTimeout(function(){e()},j):(b(".box-fold > .frames").removeAttr("style"),l())}var j=g/d,k=-100,n=-100*(d-1),p=this;"backward"==c?(pos=n,k*=-1):"forward"==c?pos=0:console.log("unkown direction for animation");e();return p}})(jQuery);(function(){var b=Math,c=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"";/android/gi.test(navigator.appVersion);var d=/iphone|ipad/gi.test(navigator.appVersion),g=/playbook/gi.test(navigator.appVersion),l=/hp-tablet/gi.test(navigator.appVersion),e="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,j="ontouchstart"in window&&!l,k=c+"Transform"in document.documentElement.style,n=d||g,p=window.requestAnimationFrame||window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,17)},r=window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout,m="onorientationchange"in window?"orientationchange":"resize",s=j?"touchstart":"mousedown",t=j?"touchmove":"mousemove",u=j?"touchend":
"mouseup",v=j?"touchcancel":"mouseup",x="translate"+(e?"3d(":"("),y=e?",0)":")",d=function(a,b){var f=document,q;this.wrapper="object"==typeof a?a:f.getElementById(a);this.wrapper.style.overflow="hidden";this.scroller=this.wrapper.children[0];this.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,
onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(q in b)this.options[q]=b[q];this.x=this.options.x;this.y=this.options.y;this.options.useTransform=k?this.options.useTransform:!1;this.options.hScrollbar=this.options.hScroll&&this.options.hScrollbar;this.options.vScrollbar=this.options.vScroll&&this.options.vScrollbar;this.options.useTransition=n&&this.options.useTransition;this.scroller.style[c+"TransitionProperty"]=this.options.useTransform?"-"+c.toLowerCase()+"-transform":
"top left";this.scroller.style[c+"TransitionDuration"]="0";this.scroller.style[c+"TransformOrigin"]="0 0";this.options.useTransition&&(this.scroller.style[c+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)");this.options.useTransform?this.scroller.style[c+"Transform"]=x+this.x+"px,"+this.y+"px"+y:this.scroller.style.cssText+=";position:absolute;top:"+this.y+"px;left:"+this.x+"px";this.refresh();this._bind(m,window);this._bind(s);j||this._bind("mouseout",this.wrapper)};d.prototype={enabled:!0,
x:0,y:0,steps:[],scale:1,handleEvent:function(a){switch(a.type){case s:if(!j&&0!==a.button)break;this._start(a);break;case t:this._move(a);break;case u:case v:this._end(a);break;case m:this._resize();break;case "mouseout":this._mouseout(a);break;case "webkitTransitionEnd":this._transitionEnd(a)}},_resize:function(){this.refresh()},_pos:function(a,b){a=this.hScroll?a:0;b=this.vScroll?b:0;this.options.useTransform?this.scroller.style[c+"Transform"]=x+a+"px,"+b+"px"+y+" scale("+this.scale+")":(a>>=0,
b>>=0,this.scroller.style.left=a+"px",this.scroller.style.top=b+"px");this.x=a;this.y=b},_start:function(a){var b=j?a.touches[0]:a,f,q;if(this.enabled){this.options.onBeforeScrollStart&&this.options.onBeforeScrollStart.call(this,a);this.options.useTransition&&this._transitionTime(0);this.zoomed=this.animating=this.moved=!1;this.dirY=this.dirX=this.absDistY=this.absDistX=this.distY=this.distX=0;if(this.options.momentum&&(this.options.useTransform?(f=getComputedStyle(this.scroller,null)[c+"Transform"].replace(/[^0-9-.,]/g,
"").split(","),q=1*f[4],f=1*f[5]):(q=1*getComputedStyle(this.scroller,null).left.replace(/[^0-9-]/g,""),f=1*getComputedStyle(this.scroller,null).top.replace(/[^0-9-]/g,"")),q!=this.x||f!=this.y))this.options.useTransition?this._unbind("webkitTransitionEnd"):r(this.aniTime),this.steps=[],this._pos(q,f);this.startX=this.x;this.startY=this.y;this.pointX=b.pageX;this.pointY=b.pageY;this.startTime=a.timeStamp||Date.now();this.options.onScrollStart&&this.options.onScrollStart.call(this,a);this._bind(t);
this._bind(u);this._bind(v)}},_move:function(a){var w=j?a.touches[0]:a,f=w.pageX-this.pointX,c=w.pageY-this.pointY,h=this.x+f,d=this.y+c,e=a.timeStamp||Date.now();this.options.onBeforeScrollMove&&this.options.onBeforeScrollMove.call(this,a);this.pointX=w.pageX;this.pointY=w.pageY;if(0<h||h<this.maxScrollX)h=this.options.bounce?this.x+f/2:0<=h||0<=this.maxScrollX?0:this.maxScrollX;if(0<d||d<this.maxScrollY)d=this.options.bounce?this.y+c/2:0<=d||0<=this.maxScrollY?0:this.maxScrollY;this.distX+=f;this.distY+=
c;this.absDistX=b.abs(this.distX);this.absDistY=b.abs(this.distY);6>this.absDistX&&6>this.absDistY||(this.options.lockDirection&&(this.absDistX>this.absDistY+5?(d=this.y,c=0):this.absDistY>this.absDistX+5&&(h=this.x,f=0)),this.moved=!0,this._pos(h,d),this.dirX=0<f?-1:0>f?1:0,this.dirY=0<c?-1:0>c?1:0,300<e-this.startTime&&(this.startTime=e,this.startX=this.x,this.startY=this.y),this.options.onScrollMove&&this.options.onScrollMove.call(this,a))},_end:function(a){if(!(j&&0!=a.touches.length)){var c=
j?a.changedTouches[0]:a,f,d,h={dist:0,time:0},e={dist:0,time:0},g=(a.timeStamp||Date.now())-this.startTime;f=this.x;d=this.y;this._unbind(t);this._unbind(u);this._unbind(v);this.options.onBeforeScrollEnd&&this.options.onBeforeScrollEnd.call(this,a);if(this.moved){if(300>g&&this.options.momentum){h=f?this._momentum(f-this.startX,g,-this.x,this.scrollerW-this.wrapperW+this.x,this.options.bounce?this.wrapperW:0):h;e=d?this._momentum(d-this.startY,g,-this.y,0>this.maxScrollY?this.scrollerH-this.wrapperH+
this.y:0,this.options.bounce?this.wrapperH:0):e;f=this.x+h.dist;d=this.y+e.dist;if(0<this.x&&0<f||this.x<this.maxScrollX&&f<this.maxScrollX)h={dist:0,time:0};if(0<this.y&&0<d||this.y<this.maxScrollY&&d<this.maxScrollY)e={dist:0,time:0}}h.dist||e.dist?(c=b.max(b.max(h.time,e.time),10),this.scrollTo(f>>0,d>>0,c)):this._resetPos(200)}else{if(j){for(f=c.target;1!=f.nodeType;)f=f.parentNode;"SELECT"!=f.tagName&&("INPUT"!=f.tagName&&"TEXTAREA"!=f.tagName)&&(d=document.createEvent("MouseEvents"),d.initMouseEvent("click",
!0,!0,a.view,1,c.screenX,c.screenY,c.clientX,c.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),d._fake=!0,f.dispatchEvent(d))}this._resetPos(200)}this.options.onTouchEnd&&this.options.onTouchEnd.call(this,a)}},_resetPos:function(a){var b=0<=this.x?0:this.x<this.maxScrollX?this.maxScrollX:this.x,f=0<=this.y||0<this.maxScrollY?0:this.y<this.maxScrollY?this.maxScrollY:this.y;b==this.x&&f==this.y?this.moved&&(this.options.onScrollEnd&&this.options.onScrollEnd.call(this),this.moved=!1):this.scrollTo(b,
f,a||0)},_mouseout:function(a){var b=a.relatedTarget;if(b)for(;b=b.parentNode;)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){a.target==this.scroller&&(this._unbind("webkitTransitionEnd"),this._startAni())},_startAni:function(){var a=this,c=a.x,f=a.y,d=Date.now(),h,e,j;a.animating||(a.steps.length?(h=a.steps.shift(),h.x==c&&h.y==f&&(h.time=0),a.animating=!0,a.moved=!0,a.options.useTransition?(a._transitionTime(h.time),a._pos(h.x,h.y),a.animating=!1,h.time?a._bind("webkitTransitionEnd"):
a._resetPos(0)):(j=function(){var g=Date.now(),k;g>=d+h.time?(a._pos(h.x,h.y),a.animating=!1,a.options.onAnimationEnd&&a.options.onAnimationEnd.call(a),a._startAni()):(g=(g-d)/h.time-1,e=b.sqrt(1-g*g),g=(h.x-c)*e+c,k=(h.y-f)*e+f,a._pos(g,k),a.animating&&(a.aniTime=p(j)))},j())):a._resetPos(400))},_transitionTime:function(a){this.scroller.style[c+"TransitionDuration"]=a+"ms"},_momentum:function(a,c,f,d,h){c=b.abs(a)/c;var e=c*c/0.0012;0<a&&e>f?(f+=h/(6/(6E-4*(e/c))),c=c*f/e,e=f):0>a&&e>d&&(d+=h/(6/
(6E-4*(e/c))),c=c*d/e,e=d);return{dist:e*(0>a?-1:1),time:c/6E-4>>0}},_offset:function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;return{left:b,top:c}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){this.scroller.style[c+"Transform"]="";this._unbind(m,window);this._unbind(s);this._unbind(t);this._unbind(u);this._unbind(v);this._unbind("mouseout",
this.wrapper);this.options.useTransition&&this._unbind("webkitTransitionEnd");this.options.onDestroy&&this.options.onDestroy.call(this)},refresh:function(){var a;this.wrapperW=this.wrapper.clientWidth;this.wrapperH=this.wrapper.clientHeight;this.scrollerW=this.scroller.offsetWidth;this.scrollerH=this.scroller.offsetHeight;this.maxScrollX=this.wrapperW-this.scrollerW;this.maxScrollY=this.wrapperH-this.scrollerH;this.dirY=this.dirX=0;this.hScroll=this.options.hScroll&&0>this.maxScrollX;this.vScroll=
this.options.vScroll&&(!this.options.bounceLock&&!this.hScroll||this.scrollerH>this.wrapperH);a=this._offset(this.wrapper);this.wrapperOffsetLeft=-a.left;this.wrapperOffsetTop=-a.top;this.scroller.style[c+"TransitionDuration"]="0";this._resetPos(200)},scrollTo:function(a,b,c,d){var e=a;this.stop();e.length||(e=[{x:a,y:b,time:c,relative:d}]);a=0;for(b=e.length;a<b;a++)e[a].relative&&(e[a].x=this.x-e[a].x,e[a].y=this.y-e[a].y),this.steps.push({x:e[a].x,y:e[a].y,time:e[a].time||0});this._startAni()},
scrollToElement:function(a,c){var d;if(a=a.nodeType?a:this.scroller.querySelector(a))d=this._offset(a),d.left+=this.wrapperOffsetLeft,d.top+=this.wrapperOffsetTop,d.left=0<d.left?0:d.left<this.maxScrollX?this.maxScrollX:d.left,d.top=0<d.top?0:d.top<this.maxScrollY?this.maxScrollY:d.top,c=void 0===c?b.max(2*b.abs(d.left),2*b.abs(d.top)):c,this.scrollTo(d.left,d.top,c)},disable:function(){this.stop();this._resetPos(0);this.enabled=!1;this._unbind(t);this._unbind(u);this._unbind(v)},enable:function(){this.enabled=
!0},stop:function(){r(this.aniTime);this.steps=[];this.animating=this.moved=!1}};"undefined"!==typeof exports?exports.iScroll=d:window.iScroll=d})();var MY_EMAIL="ebrooks@risd.edu",MY_NAME="Evan Brooks",$view,$viewScroll,$body,$index,$matte,$currItem,$itemName,$itemDate,$itemContent,whichCurrItem,INDEX,ITEM,view,IS_TOUCH;
$(function(){$view=$(".view");$viewScroll=$(".view-scroller");$body=$("body");$index=$(".index");$matte=$(".matte");$currItem=null;$itemName=$(".view .title");$itemDate=$(".view .subtitle");$itemContent=$(".view-scroller");whichCurrItem="";IS_TOUCH=isTouchDevice();INDEX=0;ITEM=1;view=INDEX;$.ajaxSetup({cache:!1});IS_TOUCH&&(new iScroll("iScroll"),$("body").addClass("i-scroll"));$("html").on("click",".inner",function(){null!=$currItem&&$currItem.removeClass("active");$currItem=$(this);$currItem.addClass("active");
openItem($currItem.attr("data-item"))});$matte.click(closeItem);$("html").on("click",".togCap",function(){$(this).parent().toggleClass("show-caption")});draggingSetup();window.addEventListener("popstate",function(){""!=window.location.hash?(whichItem=window.location.hash.split("#/"),openItem(whichItem[1])):closeItem()});$(window).resize(iRefresh);$(window).on("onorientationchange",iRefresh);$("html").on("click","[data-action = actionsheet]",function(b){b.preventDefault();$body.addClass("action-mode")});
$("html").on("click","[data-action = copy]",function(b){b.preventDefault();$(".actions input").val(MY_EMAIL);el=document.getElementById("email");el.selectionStart=0;el.selectionEnd=el.value.length});$(".actions input").blur(function(){$(".actions .flip-wrap").removeClass("flipped")});$("html").on("click","[data-flip]",function(){type=$(this).attr("data-flip");"permanent"==type?$(this).addClass("flipped"):$(this).toggleClass("flipped")});clerestorySetup()});
function openItem(b){history.pushState({},"","#/"+b);view=ITEM;b!=whichCurrItem?(whichCurrItem=b,url="/item/"+b+".html",$body.addClass("loading"),$viewScroll.scrollTop(0),$.ajax(url).done(function(b){content=b.split("==");setTitle(content[0]);$itemName.html(content[0]);$itemDate.html(content[1]);b=content[2].split("\n#");var d="";$itemContent.html("");for(i=1;i<b.length;i++){content=b[i].split("\n--");attr=content[0].split(": ");attrHtml='class="'+attr[0]+'"';var g="";1<attr.length&&(g='<img src="'+
attr[1]+'">');d+="<section "+attrHtml+">";d+=g;d+=content[1];d+="</section>"}$itemContent.append(d);$view.waitForImages(function(){$body.removeClass("loading").addClass("item-mode");iRefresh()})}).error(function(){setTitle("Nothing");$itemName.html("");$itemDate.html("");$itemContent.html('<section class="text">Not available right now</section>');$body.removeClass("loading").addClass("item-mode")})):$body.addClass("item-mode")}
function closeItem(){$body.removeClass("item-mode action-mode");view=INDEX;history.pushState({},"","/");setTitle("Portfolio")}function isTouchDevice(){var b=document.createElement("div");b.setAttribute("ongesturestart","return;");return"function"===typeof b.ongesturestart}function iRefresh(){IS_TOUCH&&setTimeout(function(){myScroll.refresh()},0)}
function clearTextSelections(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}function setTitle(b){document.title=MY_NAME+" \u2014 "+b};
